title = "Gitleaks expanded rules"

# regra simples para passwords (mantida)
[[rules]]
id = "hardcoded-password"
description = "Hardcoded password or pass-like string"
regex = '''(?i)(password|passwd|pwd|pass|secret|secret_key|secretkey|apikey|api_key|api-key|token|auth)\s*[:=]\s*['"][^'"]+['"]'''
tags = ["secret"]

# AWS Access Key ID
[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID (AKIA...)"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws","secret"]

# AWS Secret Access Key (base64-ish)
[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key (base64-like)"
regex = '''(?i)aws_secret_access_key.*[:=]\s*['"][A-Za-z0-9/+=]{40,}['"]'''
tags = ["aws","secret"]

# Generic long API keys / tokens (alphanumeric 20+)
[[rules]]
id = "generic-api-key"
description = "Generic long API key or token"
regex = '''(?i)(api[_-]?key|token|access[_-]?token|auth[_-]?token|secret[_-]?key)\s*[:=]\s*['"]?[A-Za-z0-9\-_]{20,}['"]?'''
tags = ["secret"]

# Bearer / JWT tokens in code
[[rules]]
id = "jwt-bearer"
description = "JWT or Bearer token pattern"
regex = '''(?i)(bearer\s+[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+|[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+)'''
tags = ["jwt","token"]

# PEM private key
[[rules]]
id = "private-key"
description = "PEM Private Key block"
regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH|PRIVATE) KEY-----'''
tags = ["private_key"]

# Generic base64 / hex secrets (reduce noise with min length)
[[rules]]
id = "high-entropy"
description = "High-entropy base64/hex string (likely secret)"
regex = '''(?i)[A-Za-z0-9+/=]{40,}'''
tags = ["secret","high-entropy"]
